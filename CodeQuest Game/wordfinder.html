<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Word Finder</title>
    <style>
        :root {
            --bg-color: #2c3e50;
            --cell-color: #7f8c8d;
            --grid-bg: rgba(0, 0, 0, 0.2);
            --primary-accent: #3498db;
            --secondary-accent: #f1c40f;
            --text-light: #ffffff;
            --text-dark: #2c3e50;
            --success-color: #2ecc71;
            --hint-reveal-color: #e67e22;
        }
        * {
            margin: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', sans-serif;
            background: var(--bg-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            color: var(--text-light);
            min-height: 100vh;
            overflow-x: hidden;
            padding: 20px 10px;
            user-select: none;
        }
        .header {
            position: relative;
            width: 100%;
            max-width: 600px;
            text-align: center;
        }
        h1 {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        #help-button {
            position: absolute;
            top: 50%;
            right: 0;
            transform: translateY(-50%);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.5rem;
            background: var(--primary-accent);
            color: var(--text-light);
            border: none;
            cursor: pointer;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(10, 40px);
            grid-auto-rows: 40px;
            gap: 4px;
            margin: 20px 0;
            padding: 10px;
            background: var(--grid-bg);
            border-radius: 10px;
        }
        .cell {
            width: 40px;
            height: 40px;
            background: var(--cell-color);
            border-radius: 5px;
            text-align: center;
            font-size: 24px;
            color: var(--text-light);
            font-weight: bold;
            line-height: 40px;
            text-transform: uppercase;
            transition: background-color 0.5s, transform 0.3s;
        }
        .empty {
            background: transparent;
        }
        .hint-reveal {
            background-color: var(--hint-reveal-color) !important;
            transform: scale(1.1);
        }
        .word-display-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        .word-box {
            font-size: 28px;
            font-weight: bold;
            letter-spacing: 4px;
            color: var(--secondary-accent);
        }
        .btn {
            background: var(--primary-accent);
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            color: var(--text-light);
            font-size: 16px;
            transition: background-color 0.2s;
        }
        .btn:hover {
            background: #2980b9;
        }
        .letter-wheel-container {
            position: relative;
            width: 250px;
            height: 250px;
            margin: 30px auto 0;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .letter {
            width: 60px;
            height: 60px;
            background: var(--secondary-accent);
            color: var(--text-dark);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            position: absolute;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            transition: 0.2s;
        }
        .letter.selected {
            background: var(--success-color);
        }
        #lineCanvas {
            position: absolute;
            top: 0;
            left: 0;
            pointer-events: none; 
        }
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background-color: var(--bg-color);
            padding: 20px;
            border: 2px solid var(--primary-accent);
            border-radius: 10px;
            width: 80%;
            max-width: 500px;
            position: relative;
            text-align: left;
        }
        .close-button {
            position: absolute;
            top: 10px;
            right: 20px;
            font-size: 2rem;
            cursor: pointer;
        }
        .modal-content h2 {
            text-align: center;
            color: var(--secondary-accent);
            margin-top: 0;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Word Finder</h1>
        <button id="help-button">?</button>
    </div>
    <div class="grid" id="grid"></div>
    <div class="word-display-container">
        <div class="word-box" id="currentWord">&nbsp;</div>
        <button class="btn" onclick="useHint()">Use Hint</button>
    </div>
    <div class="letter-wheel-container" id="letterWheel">
        <canvas id="lineCanvas" width="250" height="250"></canvas>
    </div>
    <div id="help-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2>How to Play</h2>
            <p>Your goal is to find all the hidden words to complete the crossword grid.</p>
            <ul>
                <li>Use your mouse or finger to drag across the letters in the wheel to form words.</li>
                <li>If you form a valid word, it will automatically be placed in the grid.</li>
                <li>You can use up to two hints to reveal a random letter in the grid.</li>
                <li>The game is won when all words have been found and the grid is complete.</li>
            </ul>
        </div>
    </div>
    <script>
        const letterSet = ['N', 'E', 'R', 'T', 'O', 'W'];
        let validWords = ['WROTE', 'TOWER', 'RENT', 'WORN', 'WORE', 'NEW', 'TEN', 'NET', 'ROT', 'TOE', 'TWO', 'TON', 'WET', 'ONE', 'WON', 'ORE', 'TONE'];
        const wordPlacements = {
            "TOWER": [44, 54, 64, 74, 84], "WROTE": [57, 67, 77, 87, 97], "WORE":  [5, 6, 7, 8],
            "RENT":  [84, 85, 86, 87], "TEN":   [20, 21, 22], "TWO":   [13, 14, 15],
            "ROT":   [25, 26, 27], "NET":   [70, 71, 72], "ORE":   [90, 91, 92],
            "TON":   [39, 49, 59], "WORN":  [5, 15, 25, 35], "TOE":   [72, 82, 92],
             "WON":   [57, 58, 59], "ONE":   [77, 78, 79],
            "TONE":  [20, 30, 40, 50], "WET":   [42, 43, 44], "NEW":   [22, 32, 42]
        };
        const grid = document.getElementById('grid');
        const wordBox = document.getElementById('currentWord');
        const letterWheel = document.getElementById('letterWheel');
        const wordDisplayContainer = document.querySelector('.word-display-container');
        const hintButton = wordDisplayContainer.querySelector('.btn');
        const lineCanvas = document.getElementById('lineCanvas');
        const ctx = lineCanvas.getContext('2d');
        const helpModal = document.getElementById("help-modal");
        const helpButton = document.getElementById("help-button");
        const closeButton = document.querySelector(".close-button");
        let isDragging = false;
        let selectedLetters = [];
        let hintsLeft = 2; 

        function initializeGame() {
            ctx.strokeStyle = 'var(--success-color)';
            ctx.lineWidth = 8;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            hintButton.textContent = `Use Hint (${hintsLeft})`;
            for (let i = 0; i < 100; i++) {
                const div = document.createElement('div');
                div.className = 'cell empty';
                div.id = 'cell-' + i;
                grid.appendChild(div);
            }
            const usedCells = new Set();
            for (const word in wordPlacements) {
                wordPlacements[word].forEach(i => usedCells.add(i));
            }
            usedCells.forEach(i => {
                const cell = document.getElementById('cell-' + i);
                if (cell) cell.classList.remove('empty');
            });
            const radius = 90;
            letterSet.forEach((letter, index) => {
                const angle = (index / letterSet.length) * 2 * Math.PI;
                const btn = document.createElement('div');
                btn.className = 'letter';
                btn.textContent = letter;
                btn.dataset.letter = letter;
                const x = radius * Math.cos(angle - Math.PI / 2);
                const y = radius * Math.sin(angle - Math.PI / 2);
                btn.style.transform = `translate(${x}px, ${y}px)`;
                letterWheel.appendChild(btn);
            });
        }
        letterWheel.addEventListener('mousedown', startDrag);
        letterWheel.addEventListener('touchstart', startDrag, { passive: false });
        document.addEventListener('mousemove', drag);
        document.addEventListener('touchmove', drag, { passive: false });
        document.addEventListener('mouseup', endDrag);
        document.addEventListener('touchend', endDrag);   
        function startDrag(e) {
            isDragging = true;
            clearSelection();
            const target = getLetterFromEvent(e);
            if (target) selectLetter(target);
            e.preventDefault();
        }
        function drag(e) {
            if (!isDragging) return;
            const target = getLetterFromEvent(e);
            if (target && !target.classList.contains('selected')) {
                selectLetter(target);
            }
            e.preventDefault();
        }
        function endDrag() {
            if (!isDragging) return;
            isDragging = false;
            submitWord();
        }
        function submitWord() {
            const word = selectedLetters.map(el => el.dataset.letter).join('');
            if (validWords.includes(word)) {
                placeWordOnGrid(word);
            }
            setTimeout(clearSelection, 200);
        }
        function placeWordOnGrid(word) {
            const indexes = wordPlacements[word];
            if (!indexes) return;
            for (let i = 0; i < word.length; i++) {
                const cell = document.getElementById('cell-' + indexes[i]);
                if (cell) {
                    cell.textContent = word[i];
                    cell.style.backgroundColor = 'var(--primary-accent)';
                }
            }
            const idx = validWords.indexOf(word);
            if (idx > -1) validWords.splice(idx, 1);
            checkWinCondition();
        }  
        function checkWinCondition() {
            if (validWords.length === 0) {
                letterWheel.style.display = 'none';
                hintButton.style.display = 'none';
                wordBox.textContent = "🎉 All Words Found!";
                wordBox.style.color = "var(--success-color)";
                const returnBtn = document.createElement('button');
                returnBtn.textContent = 'Return to Board';
                returnBtn.className = 'btn';
                returnBtn.onclick = () => { window.location.href = 'board.html'; };
                wordDisplayContainer.appendChild(returnBtn);
            }
        }
        function useHint() {
            if (hintsLeft <= 0) return; 
            const hintableCells = [];
            for (const word of validWords) {
                const placements = wordPlacements[word];
                for (let i = 0; i < placements.length; i++) {
                    const cell = document.getElementById('cell-' + placements[i]);
                    if (cell && cell.textContent === '') {
                        hintableCells.push({ cell, letter: word[i] });
                    }
                }
            }
            if (hintableCells.length > 0) {
                hintsLeft--; 
                hintButton.textContent = `Use Hint (${hintsLeft})`; 

                const hint = hintableCells[Math.floor(Math.random() * hintableCells.length)];
                hint.cell.textContent = hint.letter;
                hint.cell.classList.add('hint-reveal');
                setTimeout(() => {
                    hint.cell.classList.remove('hint-reveal');
                }, 1000);

                if (hintsLeft <= 0) {
                    hintButton.disabled = true; 
                }
            }
        }
        function getLetterFromEvent(e) {
            const point = e.touches ? e.touches[0] : e;
            return document.elementFromPoint(point.clientX, point.clientY)?.closest('.letter');
        }
        function selectLetter(letterEl) {
            letterEl.classList.add('selected');
            letterEl.style.transform += ' scale(1.1)';
            selectedLetters.push(letterEl);
            updateWordBox();
            drawConnectingLines(); 
        }
        function updateWordBox() {
            wordBox.textContent = selectedLetters.map(el => el.dataset.letter).join('');
        }
        function clearSelection() {
            ctx.clearRect(0, 0, lineCanvas.width, lineCanvas.height); 
            selectedLetters.forEach(el => {
                el.classList.remove('selected');
                el.style.transform = el.style.transform.replace(' scale(1.1)', '');
            });
            selectedLetters = [];
            updateWordBox();
        }
        function getLetterCenter(letterEl) {
            const wheelRect = letterWheel.getBoundingClientRect();
            const letterRect = letterEl.getBoundingClientRect();
            const x = (letterRect.left - wheelRect.left) + (letterRect.width / 2);
            const y = (letterRect.top - wheelRect.top) + (letterRect.height / 2);
            return { x, y };
        }
        function drawConnectingLines() {
            ctx.clearRect(0, 0, lineCanvas.width, lineCanvas.height);
            if (selectedLetters.length < 2) return;
            ctx.beginPath();
            const firstPoint = getLetterCenter(selectedLetters[0]);
            ctx.moveTo(firstPoint.x, firstPoint.y);
            for (let i = 1; i < selectedLetters.length; i++) {
                const point = getLetterCenter(selectedLetters[i]);
                ctx.lineTo(point.x, point.y);
            }
            ctx.stroke();
        }
        helpButton.onclick = () => {
            helpModal.style.display = "flex";
        };
        closeButton.onclick = () => {
            helpModal.style.display = "none";
        };
        window.onclick = (event) => {
            if (event.target == helpModal) {
                helpModal.style.display = "none";
            }
        };
        initializeGame();
    </script>
</body>
</html>